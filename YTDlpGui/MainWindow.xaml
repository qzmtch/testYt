<Window x:Class="YTDlpGui.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="yt-dlp GUI" Width="1200" Height="760" WindowStartupLocation="CenterScreen">
  <Grid Margin="16" RowDefinitions="Auto,Auto,*,Auto,Auto" ColumnDefinitions="*">
    <!-- Header -->
    <Border Style="{StaticResource PanelCard}" Padding="16" Margin="0,0,0,12">
      <DockPanel LastChildFill="True">
        <StackPanel Orientation="Horizontal" DockPanel.Dock="Left">
          <TextBlock Text="yt-dlp GUI" FontSize="20" FontWeight="Bold" />
          <TextBlock Text="  —  .NET Framework 4.7.2" Foreground="{StaticResource SubTextBrush}" VerticalAlignment="Center"/>
        </StackPanel>

        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" DockPanel.Dock="Right" >
          <TextBlock Text="Тема:" VerticalAlignment="Center" Margin="0,0,8,0"/>
          <ToggleButton x:Name="ThemeToggle" Content="Dark" Checked="ThemeToggle_Checked" Unchecked="ThemeToggle_Unchecked" />
        </StackPanel>
      </DockPanel>
    </Border>

    <!-- URL + controls -->
    <Border Grid.Row="1" Style="{StaticResource PanelCard}" Padding="16" Margin="0,0,0,12">
      <Grid ColumnDefinitions="*,Auto,Auto,Auto" RowDefinitions="Auto,Auto">
        <TextBox x:Name="UrlBox" Grid.ColumnSpan="1" Grid.Row="0" MinWidth="500" 
                 ToolTip="Вставьте ссылку на видео" />
        <Button Grid.Column="1" Grid.Row="0" Click="BtnFetch_Click" Content="Получить" />
        <Button Grid.Column="2" Grid.Row="0" Click="BtnCheckYtDlp_Click" Content="Проверить yt-dlp" />
        <Button Grid.Column="3" Grid.Row="0" Click="BtnClear_Click" Content="Очистить" />

        <StackPanel Grid.Row="1" Grid.ColumnSpan="4" Orientation="Horizontal" Margin="0,12,0,0">
          <TextBlock Text="Формат:" VerticalAlignment="Center" Margin="0,0,6,0"/>
          <ComboBox x:Name="FormatExtCombo" Width="140" SelectionChanged="Filter_SelectionChanged"/>
          <TextBlock Text="Тип:" VerticalAlignment="Center" Margin="12,0,6,0"/>
          <ComboBox x:Name="TypeCombo" Width="160" SelectionChanged="Filter_SelectionChanged"/>
          <TextBlock Text="Качество:" VerticalAlignment="Center" Margin="12,0,6,0"/>
          <ComboBox x:Name="QualityCombo" Width="160" SelectionChanged="Filter_SelectionChanged"/>
          <CheckBox x:Name="CbSubtitles" Content="Субтитры (если есть)" Margin="12,0,0,0"/>
        </StackPanel>
      </Grid>
    </Border>

    <!-- Content: left info, right thumbnail -->
    <Grid Grid.Row="2" ColumnDefinitions="2*,3*" ColumnSpacing="12">
      <Border Style="{StaticResource PanelCard}">
        <Grid>
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
          </Grid.RowDefinitions>
          <StackPanel>
            <TextBlock x:Name="TitleText" FontSize="17" FontWeight="Bold" TextWrapping="Wrap" />
            <TextBlock x:Name="UrlResolvedText" Foreground="{StaticResource SubTextBrush}" TextWrapping="Wrap" />
          </StackPanel>
          <ListView x:Name="FormatsList" Grid.Row="1" Margin="0,12,0,12" SelectionMode="Single">
            <ListView.View>
              <GridView>
                <GridViewColumn Header="ID" DisplayMemberBinding="{Binding FormatId}" Width="140" />
                <GridViewColumn Header="Контейнер" DisplayMemberBinding="{Binding Ext}" Width="80" />
                <GridViewColumn Header="Качество" DisplayMemberBinding="{Binding Resolution}" Width="110" />
                <GridViewColumn Header="FPS" DisplayMemberBinding="{Binding Fps}" Width="60" />
                <GridViewColumn Header="VCodec" DisplayMemberBinding="{Binding VCodec}" Width="120" />
                <GridViewColumn Header="ACodec" DisplayMemberBinding="{Binding ACodec}" Width="120" />
                <GridViewColumn Header="Битрейт" DisplayMemberBinding="{Binding Tbr}" Width="90" />
                <GridViewColumn Header="Примечание" DisplayMemberBinding="{Binding Note}" Width="220" />
              </GridView>
            </ListView.View>
          </ListView>
          <TextBlock Grid.Row="2" Text="Выберите формат из списка или задайте фильтры сверху" Foreground="{StaticResource SubTextBrush}"/>
        </Grid>
      </Border>

      <Border Grid.Column="1" Style="{StaticResource PanelCard}">
        <Grid ColumnDefinitions="Auto,*" RowDefinitions="Auto,*">
          <Image x:Name="ThumbImage" Grid.ColumnSpan="2" Height="200" Stretch="UniformToFill" Margin="0,0,0,8"/>
          <TextBlock Text="Описание:" Grid.Row="1" FontWeight="SemiBold" />
          <ScrollViewer Grid.Row="1" Grid.Column="1" Margin="8,0,0,0">
            <TextBlock x:Name="DescText" TextWrapping="Wrap" />
          </ScrollViewer>
        </Grid>
      </Border>
    </Grid>

    <!-- Actions -->
    <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,12,0,12">
      <Button x:Name="BtnDownload" Content="Скачать" Click="BtnDownload_Click"/>
      <Button x:Name="BtnCancel" Content="Отмена" Click="BtnCancel_Click"/>
      <Button x:Name="BtnOpenFolder" Content="Открыть папку" Click="BtnOpenFolder_Click"/>
    </StackPanel>

    <!-- Progress + log -->
    <Border Grid.Row="4" Style="{StaticResource PanelCard}">
      <Grid RowDefinitions="Auto,*" RowSpacing="8">
        <ProgressBar x:Name="Progress" Minimum="0" Maximum="100" />
        <TextBox x:Name="LogBox" Grid.Row="1" AcceptsReturn="True" VerticalScrollBarVisibility="Auto" TextWrapping="Wrap" FontFamily="Consolas" Background="{StaticResource PanelBrush}" />
      </Grid>
    </Border>
  </Grid>
</Window>
